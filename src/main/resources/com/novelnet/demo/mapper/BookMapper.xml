<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.novelnet.demo.mapper.BookMapper">
    <select id="getType" resultType="com.novelnet.demo.pojo.Book">
        select distinct type from `book`
    </select>

    <select id="getBooks" resultType="com.novelnet.demo.pojo.Book">
        select bid, name, author, update_time, introduction, state, type, recommend_num, collect_time, img_path
        from `book`
        <where>
            <if test="type != null and type != ''">
                type = #{type}
            </if>
            <if test="name != null and name != ''">
                and name like %${name}%
            </if>
        </where>
    </select>

    <resultMap id="bookMap" type="com.novelnet.demo.pojo.Book">
        <id property="bid" column="bid"/>
        <collection property="chapters" javaType="List" ofType="com.novelnet.demo.pojo.Book">
            <id property="bid" column="bid"/>
        </collection>
    </resultMap>

    <select id="getBook" resultMap="bookMap">
        select *
        from `book`
        where bid = #{bid}
    </select>
</mapper>